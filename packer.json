{
    "variables": {
	"docker-registry": "dr.rbkmoney.com",
	"files-dir": "{{env `PWD`}}/files/",
	"portage-root-dir": "{{env `PWD`}}/portage-root/",
	"shared-dir": "{{env `HOME`}}/.cache/rbkmoney/images/shared/",
	"image-tag": null
    },
    "builders": [
	{
	    "type": "docker",
            "image": "{{user `docker-registry`}}/rbkmoney/build:10ace69bc3a1fc3179672098b7be081f9f6018b2",
	    "run_command": ["-d", "-i", "-t", "{{.Image}}", "/bin/sh"],
	    "volumes": {
		"{{user `files-dir`}}": "/tmp/data:ro",
		"{{user `portage-root-dir`}}": "/tmp/portage-root",
		"{{user `shared-dir`}}/portage": "/usr/portage:rw"
	    },
	    "pull": "false",
	    "commit": "true"
	}
    ],
    "provisioners": [
	{
	    "type": "shell",
	    "script": "{{user `files-dir`}}/packer.sh"
	}
    ]
}
